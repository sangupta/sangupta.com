---
layout: default
title: encodeURIComponent and decodeURIComponent in Java
permalink: /2010/05/encodeuricomponent-and.html
redirect_from: "/2010/05/encodeuricomponent-and.html"
date: Sat May 15 22:00:00 IST 2010
sharingURL: http://blog.sangupta.com/2010/05/encodeuricomponent-and.html
tags: coding-techniques java web
---
A very common task when working with Webservices, is to encode/decode specific URI components, and for there is no direct API in Java for the same, it gets a difficult. Below is the code piece that I have been using for quite some time now. 
<br>
<br>Hope this helps.
<br>
<br>
<pre class="brush: java">public static final String ALLOWED_CHARS = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-_.!~*'()";<br><br> public static String encodeURIComponent(String input) {<br>  if(StringUtils.isEmpty(input)) {<br>   return input;<br>  }<br>  <br>  int l = input.length();<br>  StringBuilder o = new StringBuilder(l * 3);<br>  try {<br>   for (int i = 0; i &lt; l; i++) {<br>    String e = input.substring(i, i + 1);<br>    if (ALLOWED_CHARS.indexOf(e) == -1) {<br>     byte[] b = e.getBytes("utf-8");<br>     o.append(getHex(b));<br>     continue;<br>    }<br>    o.append(e);<br>   }<br>   return o.toString();<br>  } catch(UnsupportedEncodingException e) {<br>   e.printStackTrace();<br>  }<br>  return input;<br> }<br> <br> private static String getHex(byte buf[]) {<br>  StringBuilder o = new StringBuilder(buf.length * 3);<br>  for (int i = 0; i &lt; buf.length; i++) {<br>   int n = (int) buf[i] &amp; 0xff;<br>   o.append("%");<br>   if (n &lt; 0x10) {<br>    o.append("0");<br>   }<br>   o.append(Long.toString(n, 16).toUpperCase());<br>  }<br>  return o.toString();<br> }<br><br> public static String decodeURIComponent(String encodedURI) {<br>  char actualChar;<br><br>  StringBuffer buffer = new StringBuffer();<br><br>  int bytePattern, sumb = 0;<br><br>  for (int i = 0, more = -1; i &lt; encodedURI.length(); i++) {<br>   actualChar = encodedURI.charAt(i);<br><br>   switch (actualChar) {<br>    case '%': {<br>     actualChar = encodedURI.charAt(++i);<br>     int hb = (Character.isDigit(actualChar) ? actualChar - '0'<br>       : 10 + Character.toLowerCase(actualChar) - 'a') &amp; 0xF;<br>     actualChar = encodedURI.charAt(++i);<br>     int lb = (Character.isDigit(actualChar) ? actualChar - '0'<br>       : 10 + Character.toLowerCase(actualChar) - 'a') &amp; 0xF;<br>     bytePattern = (hb &lt;&lt; 4) | lb;<br>     break;<br>    }<br>    case '+': {<br>     bytePattern = ' ';<br>     break;<br>    }<br>    default: {<br>     bytePattern = actualChar;<br>    }<br>   }<br><br>   if ((bytePattern &amp; 0xc0) == 0x80) { // 10xxxxxx<br>    sumb = (sumb &lt;&lt; 6) | (bytePattern &amp; 0x3f);<br>    if (--more == 0)<br>     buffer.append((char) sumb);<br>   } else if ((bytePattern &amp; 0x80) == 0x00) { // 0xxxxxxx<br>    buffer.append((char) bytePattern);<br>   } else if ((bytePattern &amp; 0xe0) == 0xc0) { // 110xxxxx<br>    sumb = bytePattern &amp; 0x1f;<br>    more = 1;<br>   } else if ((bytePattern &amp; 0xf0) == 0xe0) { // 1110xxxx<br>    sumb = bytePattern &amp; 0x0f;<br>    more = 2;<br>   } else if ((bytePattern &amp; 0xf8) == 0xf0) { // 11110xxx<br>    sumb = bytePattern &amp; 0x07;<br>    more = 3;<br>   } else if ((bytePattern &amp; 0xfc) == 0xf8) { // 111110xx<br>    sumb = bytePattern &amp; 0x03;<br>    more = 4;<br>   } else { // 1111110x<br>    sumb = bytePattern &amp; 0x01;<br>    more = 5;<br>   }<br>  }<br>  return buffer.toString();<br> }<br></pre>
