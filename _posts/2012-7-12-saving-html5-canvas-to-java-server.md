---
layout: default
title: Saving HTML5 canvas to Java server
permalink: /2012/07/saving-html5-canvas-to-java-server.html
redirect_from: "/2012/07/saving-html5-canvas-to-java-server.html"
date: Thu Jul 12 14:10:00 IST 2012
sharingURL: http://blog.sangupta.com/2012/07/saving-html5-canvas-to-java-server.html
tags: coding-techniques java
---
If you are working with HTML5 Canvas element and are looking to save the generated PNG file back on to the server via Java - it is not as easy as saving the byte array. The reason that the generated PNG data is URL encoded and is prefixed with the dataURI format headers.
<br>
<br>
<pre class="brush: javascript">    var canvas = document.getElementById('#myCanvas');<br>    var pngData = canvas.toDataURL('image/png');<br></pre>
<br>The following code will convert the raw bytes by stripping off the headers, and coverting the Base64 encoded data to the raw PNG bytes.
<br>
<br>
<pre class="brush: java">private void saveImage(byte[] pngData) {<br> String png = new String(pngData);<br> String find = "base64%2C";<br> String tokens = png.substring(png.indexOf(find) + find.length());<br> String decoded = StringUtils.replace(tokens, "%2F", "/");<br> byte[] bytes = new Base64Encoder().decode(decoded);<br><br> // save the generated bytes<br> // which can then be read in a BufferedImage<br> BufferedImage image = ImageIO.read(new ByteArrayInputStream(bytes));<br> <br> // mroe code<br>}<br></pre>
<br>Hope this helps.
<br>
